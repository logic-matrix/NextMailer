{% extends "base.html" %}
{% block title %}NextMailer - Uploads{% endblock %}

{% block content %}
<br><br><br>
<h2>Uploads</h2>

<!-- Upload Form -->
<form method="POST" enctype="multipart/form-data" action="">
    <div class="row mb-3">
        <div class="col-md-6">
            <label for="name" class="form-label">Image Name</label>
            <input type="text" class="form-control" name="name" placeholder="Enter image name" required>
        </div>
        <div class="col-md-6">
            <label for="file" class="form-label">Select Image</label>
            <input type="file" class="form-control" name="file" accept="image/*" onchange="previewImage(event)"
                required>
        </div>
    </div>

    <button type="submit" class="btn btn-primary">Upload</button>
</form>

<hr>

<!-- Image Preview Section -->
<div id="preview-section" style="display:none; margin-top:20px;">
    <h4>Preview</h4>
    <img id="preview" src="" alt="Uploaded Image"
        style="max-width:300px; border:1px solid #ccc; padding:5px; border-radius:8px;">
    <br><br>
    <form method="POST" action="">
        <input type="hidden" name="delete_name" id="delete_name">
        <button type="submit" class="btn btn-danger">Delete</button>
    </form>
</div>

<script>
    function previewImage(event) {
        const preview = document.getElementById('preview');
        const previewSection = document.getElementById('preview-section');
        const fileInput = event.target;
        const deleteInput = document.getElementById('delete_name');

        if (fileInput.files && fileInput.files[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
                preview.src = e.target.result;
                previewSection.style.display = 'block';
                deleteInput.value = fileInput.files[0].name;
            }
            reader.readAsDataURL(fileInput.files[0]);
        }
    }
</script>

{% endblock %}